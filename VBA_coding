Sub Stock_data()' Loop through all the worksheetsFor Each ws In Worksheets' Loop through all rowsDim Last_Row As Long' Find the last row in each worksheetLast_Row = ws.Cells(Rows.Count, 1).End(xlUp).Row' Set stock ticker symbol name and location of each stockDim Summary_Table_Row As IntegerSummary_Table_Row = 2' Set header row on all sheetsws.Range("I1").Value = "Ticker"ws.Range("I1").Font.Bold = Truews.Range("J1").Value = "Yearly Change"ws.Range("J1").Font.Bold = Truews.Range("K1").Value = "Percent Change"ws.Range("K1").Font.Bold = Truews.Range("L1").Value = "Total Stock Volume"ws.Range("L1").Font.Bold = True' Define the variables needed to create columnsDim Ticker_Name As StringDim Open_Total As DoubleDim Close_Total As DoubleDim Yearly_Change As DoubleDim Percent_Change As DoubleDim Stock_Volume As LongLongOpen_Total = Cells(2, 3).ValueStock_Volume = 0    For i = 2 To Last_Row            If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then                ' Set the stock symbol name                Ticker_Name = ws.Cells(i, 1).Value                                ' Print the stock symbol in the sheet                ws.Range("I" & Summary_Table_Row).Value = Ticker_Name                                ' Get the starting and ending balance for the stock symbol                Close_Total = ws.Cells(i, 6).Value                Yearly_Change = Close_Total - Open_Total                                ' Print the yearly change in the sheet                ws.Range("J" & Summary_Table_Row).Value = Yearly_Change                                       ' Print the percent change in the sheet, case if dividing by 0                    If Open_Total = 0 Then                        Yearly_Change = 0                        Percent_Change = 0                                            Else                        Percent_Change = Yearly_Change / Open_Total                                            End If                                   ' Print the percent change in the table                ws.Range("K" & Summary_Table_Row).Value = Percent_Change                ws.Range("K" & Summary_Table_Row).Style = "percent"                                ' Print the total stock value                ws.Range("L" & Summary_Table_Row).Value = Stock_Volume                                ' Reset the values for the next ticker symbol                Open_Total = ws.Cells(i + 1, 3).Value                Stock_Volume = 0                Summary_Table_Row = Summary_Table_Row + 1                        Else                            ' Add to the total stock value                Stock_Volume = Stock_Volume + ws.Cells(i, 7).Value                    End If                        ' Print the Yearly Change box as Red (for -) or Green (for +)            If ws.Cells(i, 10).Value < 0 Then                ws.Cells(i, 10).Interior.ColorIndex = 3                             ElseIf ws.Cells(i, 10).Value > 0 Then                ws.Cells(i, 10).Interior.ColorIndex = 4                            End If                    Next i        Next wsEnd Sub